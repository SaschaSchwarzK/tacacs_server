[server]
host = 0.0.0.0
port = 49
log_level = INFO
max_connections = 50
socket_timeout = 30
listen_backlog = 128
client_timeout = 12
max_packet_length = 4096
ipv6_enabled = false
tcp_keepalive = true
tcp_keepidle = 60
tcp_keepintvl = 10
tcp_keepcnt = 5
thread_pool_max = 100
use_thread_pool = true
accept_proxy_protocol = true
proxy_enabled = true

[auth]
backends = local,okta
local_auth_db = data/local_auth.db
require_all_backends = false
local_auth_cache_ttl_seconds = 60
backend_timeout = 2.0

[ldap]
server = ldap://localhost:389
base_dn = ou=people,dc=example,dc=com
user_attribute = uid
bind_dn = 
bind_password = 
use_tls = false
timeout = 10

[database]
accounting_db = data/tacacs_accounting.db
cleanup_days = 90
auto_cleanup = true
metrics_history_db = data/metrics_history.db
audit_trail_db = data/audit_trail.db
metrics_retention_days = 30
audit_retention_days = 90
db_pool_size = 5

[security]
max_auth_attempts = 3
auth_timeout = 300
encryption_required = true
allowed_clients = 
denied_clients = 
rate_limit_requests = 60
rate_limit_window = 60
max_connections_per_ip = 20

[webhooks]
urls = 
headers_json = {}
template_json = {}
timeout = 3
threshold_count = 0
threshold_window = 60

[logging]
log_file = logs/tacacs.log
log_format = %(asctime)s - %(name)s - %(levelname)s - %(message)s
log_rotation = true
max_log_size = 10MB
backup_count = 5

[syslog]
enabled = false
host = 127.0.0.1
port = 514
protocol = udp
facility = local0
severity = info
format = rfc5424
app_name = tacacs_server
include_hostname = true

[command_authorization]
default_action = deny
rules_json = [{"action":"permit","match_type":"prefix","pattern":"show ","min_privilege":1}]
privilege_check_order = before

[backup]
enabled = true
create_on_startup = false
temp_directory = data/backup_temp
encryption_enabled = false
encryption_passphrase = 
default_retention_strategy = simple
default_retention_days = 30
gfs_keep_daily = 7
gfs_keep_weekly = 4
gfs_keep_monthly = 12
gfs_keep_yearly = 3
compression_level = 6

[admin]
username = admin
password_hash = $2b$12$vj2m47XxypTDfG/ZOaUeP.a2lROwySqp7kWzb7OmV/UNHtcOFnA2G
session_timeout_minutes = 60

[devices]
database = data/devices.db
default_group = default
identity_cache_ttl_seconds = 60
identity_cache_size = 10000

[radius]
enabled = true
auth_port = 1812
acct_port = 1813
host = 0.0.0.0
share_backends = true
share_accounting = true
workers = 7
socket_timeout = 1.0
rcvbuf = 1048576

[monitoring]
enabled = true
web_host = 127.0.0.1
web_port = 8080
prometheus_enabled = true
dashboard_refresh_seconds = 30

[proxy_protocol]
enabled = false
validate_sources = true
reject_invalid = true
accept_headers = true

[okta]
org_url = https://integrator-5454623.okta.com
api_token = ${OKTA_API_TOKEN}      # required for group lookups
verify_tls = true
mfa_enabled = true

