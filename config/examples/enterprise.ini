[server]
host = 0.0.0.0
port = 49
log_level = INFO
max_connections = 500
socket_timeout = 30

[auth]
backends = local, ldap, okta
local_auth_db = /var/lib/tacacs/local_auth.db
require_all_backends = false

[ldap]
server = ldap://ldap.example.com:389
base_dn = ou=people,dc=example,dc=com
user_attribute = uid
bind_dn = ${LDAP_BIND_DN}
bind_password = ${LDAP_BIND_PASSWORD}
use_tls = false
timeout = 10
pool_size = 10

[okta]
org_url = https://company.okta.com
verify_tls = true
request_timeout = 10
pool_maxsize = 100
max_retries = 2
backoff_factor = 0.3
require_group_for_auth = false
group_cache_ttl = 1800
group_cache_maxsize = 50000
authn_enabled = true

[database]
accounting_db = /var/lib/tacacs/tacacs_accounting.db
metrics_history_db = /var/lib/tacacs/metrics_history.db
audit_trail_db = /var/lib/tacacs/audit_trail.db
cleanup_days = 90
auto_cleanup = true

[security]
max_auth_attempts = 3
auth_timeout = 300
encryption_required = true
rate_limit_requests = 120
rate_limit_window = 60
max_connections_per_ip = 40

[monitoring]
enabled = true
web_host = 0.0.0.0
web_port = 8080

[radius]
enabled = true
auth_port = 1812
acct_port = 1813
host = 0.0.0.0
share_backends = true
share_accounting = true
